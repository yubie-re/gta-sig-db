<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GTA V Anticheat Signatures</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link href="https://cdn.datatables.net/2.0.5/css/dataTables.bootstrap5.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
</head>

<body data-bs-theme="dark">
    <nav class="navbar bg-primary">
        <div class="container-fluid">
            <a class="navbar-brand" href="https://github.com/yubie-re">
                <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/5/53/Rockstar_Games_Logo.svg/835px-Rockstar_Games_Logo.svg.png"
                    style="width:40px" />
                GTA 5 Signature Database
            </a>
        </div>
    </nav>

    <div class="container mx-auto p-2">
        <p class="lead">This contains all past signatures (starting 4/18/2024) added to GTA V's anticheat system.
            Translations of signature hashes are provided when possible.</p>
        <h3>Cheat Signatures</h3>
        <p>Used to detect cheats which are injected</p>
        <table id="rtmaTable" class="table table-striped">
        </table>
        <h3>Integ Signatures</h3>
        <p>Used to ensure certain memory is not modified</p>
        <table id="intgTable" class="table table-striped">
        </table>
    </div>
    <script src="https://code.jquery.com/jquery-3.7.1.js"></script>
    <script src="https://cdn.datatables.net/2.0.5/js/dataTables.js"></script>
    <script src="https://cdn.datatables.net/2.0.5/js/dataTables.bootstrap5.js"></script>

    <script>
        function timeConverter(unix){
            var a = new Date(unix * 1000);
            return a.toISOString().substring(0, 10);  
        }
         
        function flagToString(flag){
            switch(flag)
            {
                case 0x10:
                    return "X";
                case 0x20:
                    return "RX";
                case 0x40:
                    return "RWX";
                case 0x80:
                    return "RWEC";
                case 1:
                    return "NA";
                case 2:
                    return "R";
                case 4:
                    return "RW";
                case 8:
                    return "RC";
                default:
                    return "UNK";
            }
            return "UNK";
        }

        fetch('https://raw.githubusercontent.com/yubie-re/gta-sig-db/main/sig_db.json')
            .then(response => response.json())
            .then(data => {

                console.log(data);
                var rtmaArr = [];
                var integArr = [];
                data['RTMA'].forEach(dat => {
                    rtmaArr.push([String(dat.m_firstByte) + " - " + String.fromCharCode(dat.m_firstByte), String(dat.m_len), String(dat.m_hash), String(dat.m_pageLow), String(dat.m_pageHigh), flagToString(dat.m_protFlags), String(dat.m_moduleSize), timeConverter(dat.time), String(dat.build), '<code>' + (dat.translation || '') + '</code>']);
                });
                data['INTG'].forEach(dat => {
                    integArr.push([String(dat.m_firstByte) + " - " + String.fromCharCode(dat.m_firstByte), String(dat.m_len), String(dat.m_hash), String(dat.m_pageLow), String(dat.m_pageHigh), timeConverter(dat.time), String(dat.build), String(dat.build), '<code>' + (dat.translation || '') + '</code>']);
                });
                new DataTable('#rtmaTable', { data: rtmaArr,  order: [[7, 'desc']], columns: [{ title: "First Byte" }, { title: "Size" }, { title: "Hash" }, { title: "Pg Low" }, { title: "Pg High" }, { title: "Flags" }, { title: "Region Size (KB)" }, { title: "Time" }, { title: "Build" }, { title: "Translation" }] });
                new DataTable('#intgTable', { data: integArr,  order: [[4, 'desc']], columns: [{ title: "First Byte" }, { title: "Size" }, { title: "Hash" }, { title: "Pg Low" }, { title: "Pg High" }, { title: "Time" }, { title: "Build" }, { title: "Translation" }] });
            })
            .catch(error => {
                console.error('Error loading or parsing the JSON data:', error);
                alert('Failed to load JSON data: ' + error.message);
            });
    </script>
</body>

<footer>
    <div class="container">
        <footer class="d-flex flex-wrap justify-content-between align-items-center py-3 my-4 border-top">
            <div class="col-md-4 d-flex align-items-center">
                <span class="mb-3 mb-md-0 text-muted"><a href="https://github.com/yubie-re" class="text-muted">Â©2024
                        yubie-re</a></span>
            </div>

            <ul class="nav col-md-4 justify-content-end list-unstyled d-flex">
                <a class="text-muted" href="https://github.com/yubie-re/gtav-sigscan"><i class="bi bi-github"></i></use>
                    </svg></a>
            </ul>
        </footer>
    </div>
</footer>

</html>